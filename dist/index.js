function e(e,t,r){if(t=t||{},arguments.length>3){r=[r];for(let e=3;e<arguments.length;e++)r.push(arguments[e])}null!=r&&(t.children=r);let n={type:e,props:t},o=t.key;return null!=o&&(n.key=""+o),n}function t(t){return null!=t&&"boolean"!=typeof t||(t=""),"string"==typeof t||"number"==typeof t?e(null,null,""+t):t}const r=[],n={},o=Symbol("Atomico.state"),s="localName",l="host",i=97,a=116,c=79,u=77,d=73,p=67,h={children:1},f={innerHTML:1,textContent:1,contenteditable:1},y={className:1,id:1,checked:1,value:1,selected:1},m={},b={};function g(e,t){let r=e.length;if(r!==t.length)return!1;for(let n=0;n<r;n++)if(e[n]!==t[n])return!1;return!0}let w,v,k=Promise.prototype.then.bind(Promise.resolve());function x(e){return"function"==typeof e}function $(e,t,r,n,o,s,l){if(r=null==r?null:r,n=null==n?null:n,(t="class"!=t||o?t:"className")in e&&y[t]&&(r=e[t]),n!==r)if("o"!=t[0]||"n"!=t[1]||!x(n)&&!x(r))switch(t){case"ref":n&&(n.current=e);break;case"style":!function(e,t,r){let n=t,o=r;if("object"==typeof o){o="";for(let e in r)r[e]&&(b[e]||(b[e]=e.replace(/([A-Z])/g,"-$1").toLowerCase()),o+=`${b[e]}:${r[e]};`)}n!=o&&(e.style.cssText=o)}(e,r||e.style.cssText,n);break;case"shadowDom":"attachShadow"in e&&(e.shadowRoot&&!n||!e.shadowRoot&&n)&&e.attachShadow({mode:n?"open":"closed"});break;case"key":t="data-key",null==n?delete e.dataset.key:e.dataset.key=n;break;default:!o&&"list"!=t&&t in e?e[t]=null==n?"":n:null==n?e.removeAttribute(t):e.setAttribute(t,n)}else!function(e,t,r,n,o){m[t]||(m[t]=t.slice(2).toLocaleLowerCase());t=m[t],n.handleEvent||(n.handleEvent=(e=>n[e.type].call(o,e)));r?(n[t]||e.addEventListener(t,n),n[t]=r):n[t]&&(e.removeEventListener(t,n),delete n[t])}(e,t,n,s,l)}function C(){if(!w)throw new Error("the hooks can only be called from an existing functional component in the diff queue");return w}function N(e,t){let r,n,o=C().component,s=v++;return o.hooks[s]||(n=!0,o.hooks[s]=[t,e=>{r[2]&&(r[0]=r[2](r[0],e))}]),(r=o.hooks[s])[2]=e,n&&r[1]({type:i}),r}function A(e,t){let r=e.length;for(let n=0;n<r;n++){let r=e[n],o=r.hooks,s=o.length;t.type===p&&(r.remove=!0);for(let e=0;e<s;e++){o[e][1](t)}}}function S(e,r){let n,o=[];function s(i,d){if(!n)return;if(!x((i=t(i)).type))return A(o.splice(d),{type:p}),n=E(e,n,i,r,l),void(o.length&&(n[e.id].updateComponent=l));let h,f,y=o[d]||{};y.type!=i.type&&(A(o.splice(d),{type:p}),o[d]=function e(t,r){for(let e in r)t[e]=r[e];for(let r=2;r<arguments.length;r++)e(t,arguments[r]);return t}({hooks:[],ref:{get current(){return n}}},i),h=!0,f=!0),y=o[d];let m=i.props,b=y.props;if(!f){let e=Object.keys(b).length,t=0;for(let e in m)if(t++,m[e]!=b[e]){f=!0;break}f=f||e!=t}y.props=m,f&&!y.prevent&&function e(){if(y.remove)return n;w={component:y,next(){y.prevent||(y.prevent=!0,k(()=>{y.prevent=!1,e()}))}},v=0,A([y],{type:a});let t=y.type(y.props);w=!1,v=0,s(t,d+1),A([y],{type:h?c:u}),h=!1}()}function l(e,t,r){switch(e){case a:return n=t,s(r,0),n;case d:A([].concat(o).reverse(),{type:e});break;case p:n=!1,A(o.reverse(),{type:e}),o=[]}}return l}function E(e,n,o,i,c){let{vnode:u,updateComponent:d,handlers:p={}}=n&&n[e.id]||{};if(u==o)return n;u=u||{props:{}};let{type:y,props:m}=o,{shadowDom:b,children:g}=m,w=x(y);if(i=i||"svg"==y,w&&!d&&(d=S(e,i)),!w&&y!=l&&function(e){if(!e)return;e[s]||(e[s]=e.nodeName.toLowerCase());let t=e[s];return"#text"==t?null:t}(n)!==y){let t=M(y,i),r=n&&n.parentNode;r&&(L(e,n,!0,c),r.replaceChild(t,n)),n=t,p={}}if(d&&c!=d)return d(a,n,o);if(null==y)n.nodeValue!=g&&(n.nodeValue=g);else{(function(e,t,r,n,o,s){t=t||{};for(let s in t)h[s]||s in r||$(e,s,t[s],null,n,o);let l;for(let i in r)h[i]||($(e,i,t[i],r[i],n,o,s),l=l||f[i]);return l})(n,u.props,o.props,i,p,e.bind)||u.props.children==g||function(e,n,o,s){let l=[],i=function e(n,o,s,l,i=0){s=s||[];l=l||[];if(a=n,Array.isArray(a)){let t=n.length;for(let r=0;r<t;r++)e(n[r],o,s,l,i+1)}else{if(null==n&&!i)return r;let e=o?o(n,l.length):t(n);o||"object"==typeof e&&null!=e.key&&-1==s.indexOf(e.key)&&(s.push(e.key),s.withKeyes=!0),l.push(e)}var a;return l}(o,!1,l),a=i.length,c=n.childNodes,u={},d=c.length,p=l.withKeyes,h=p?0:d>a?a:d;for(;h<d;h++){let t=c[h],r=h;p&&(r=t.dataset.key,l.indexOf(r)>-1)?u[r]=t:(L(e.id,t),h--,d--,n.removeChild(t))}for(let t=0;t<a;t++){let r=i[t],o=c[t],l=p?r.key:t,a=p?u[l]:o;p&&a&&a!=o&&n.insertBefore(a,o);let d=E(e,!a&&x(r.type)?M(null):a,r,s);a||(c[t]?n.insertBefore(d,c[t]):n.appendChild(d))}}(e,b&&n.shadowRoot||n,g,i)}return n[e.id]={vnode:o,handlers:p},n}function L(e,t,r,n){let{updateComponent:o}=t[e]||{},s=t.childNodes,l=s.length;o&&o!=n&&o(r?d:p);for(let t=0;t<l;t++)L(e,s[t])}function M(e,t){let r,n=document;return r=null!=e?t?n.createElementNS("http://www.w3.org/2000/svg",e):n.createElement(e):n.createTextNode("")}function P(r,s,i=n){let a={id:i.id||o,bind:i.bind,host:i.host};r=t(r),a.host||r.type==l||(r=e(l,{},r)),E(a,s,r)}function B(e,t){N((r,n)=>{switch(n.type){case i:return{args:t};case a:case p:if(r.clear){(n.type==p||!t||!r.args||!g(t,r.args))&&r.clear.then(e=>e&&e())}return{args:t};case c:case u:let o=n.type==c||!t||!r.args||!g(t,r.args),s=r.clear;return o&&(s=k(e)),{clear:s,args:t}}return r})}function O(e){return JSON.parse(e)}class j extends HTMLElement{constructor(){super(),this.props={},this.mounted=new Promise(e=>this.mount=e),this.unmounted=new Promise(e=>this.unmount=e)}connectedCallback(){this.mount()}disconnectedCallback(){this.unmount()}attributeChangedCallback(e,t,r){t!=r&&this.setProperty(e,r)}static get observedAttributes(){let e=this.observables||{},t=[],r=(e,t,r)=>{Object.defineProperty(this.prototype,e,{set(n){if(r===Boolean){let e=this.hasAttribute(t);if(n&&e||!n&&!e)return;this[n?"setAttribute":"removeAttribute"](t,"")}else this.setProperty(e,n)},get(){return this.props[e]}})};for(let n in e){let o=n.replace(/([A-Z])/g,"-$1").toLowerCase();t.push(o),name in this.prototype||r(n,o,e[n])}return t}setProperty(e,t){e=e.replace(/-(\w)/g,(e,t)=>t.toUpperCase());let r,{observables:n}=this.constructor,o=n[e];try{if("string"==typeof t)switch(o){case Boolean:t=1==O(t||"true");break;case Number:t=Number(t);break;case Object:case Array:t=O(t);break;case Function:t=window[t]}}catch(e){r=!0}if((r||{}.toString.call(t)!=`[object ${o.name}]`)&&null!=t)throw`the observable [${e}] must be of the type [${o.name}]`;this.props[e]!==t&&this.update({[e]:t})}}class z extends j{constructor(){let t;super();let r={id:Symbol("state"),bind:this,host:!0},{styles:n}=this.constructor;this.render=this.render.bind(this);let o={};this.update=(s=>{for(let e in s)o[e]=s[e];t||(t=!0,this.mounted.then(()=>{let s=this.props={...this.props};for(let e in o){null==o[e]?delete s[e]:s[e]=o[e]}o={},P(e(this.render,s),this,r),t=!1,n&&this.shadowRoot&&(this.shadowRoot.adoptedStyleSheets=n,n=null)}))}),this.unmounted.then(()=>P("",this,r)),this.update()}}function D(){let[e,t]=function(e){let t=N(0,[])[0];if(!t[1]){let r=C().next;t.push(x(e)?e():e,function(e){t[0]=x(e)?e():e,r()})}return t}(!1),r=C().component.ref;return B(()=>{let{current:e}=r;new IntersectionObserver(([e])=>{e.isIntersecting?t(!0):t(!1)},{rootMargin:"200px 0px"}).observe(e)},[r]),e}function R(e){let t=[];return{src:e.replace(/([^,])$/,"$1,").replace(/\s+/g," ").replace(/([^,]+) +((?:\d+)(?:w|h)(?:!){0,1}(&&(?:\d+)(?:w|h)(?:!){0,1}){0,}),/g,(e,r,n)=>{let{media:o,sizes:s}=function(e){let t=[];return{media:e.replace(/&&/g," and ").replace(/(\d+)(\w|h)(!){0,1}/g,(e,r,n,o)=>(t.push(Number(r)*(o?-1:1)),`(${o?"min-":"max-"}${"w"==n?"width":"height"}: ${r}px)`)),sizes:t}}(n);return t.push({src:r,media:o,order:s.reduce((e,t)=>e+t,0)}),o?"":e}).replace(/, *$/,""),sources:t.sort((e,t)=>e.order>t.order?1:-1)}}function T({sources:t=[],src:r="",intercepted:n}){let o=N(0,{current:s})[0];var s;return B(()=>{o.current[n?"play":"pause"]()},[n]),e("video",{ref:o},t.map(t=>e("source",{src:t.src,media:t.media})),e("source",{src:r}))}function H({sources:t=[],src:r="",styleMedia:n}){return e("picture",null,t.map(t=>e("source",{srcset:t.src,media:t.media})),r&&e("img",{src:r,style:n||"max-width:var(--max-width,100%);max-height:var(--max-height,100%);display:inline-block;"}))}function I(e){return`:host{${/ *url\(/.test(e)?`background:${e}`:`background:url(${e})`}}`}function K({sources:t,src:r}){return t=[].concat(t).reverse(),e("style",null,r&&I(r),t.map(e=>`@media ${e.media}{${I(e.src)}}`))}function V({type:t,srcset:r="",lazy:n,shadowDom:o,styleMedia:s}){let l=function(e,t){let r=N(0,[])[0];return(!r[0]||r[0]&&!g(r[0],t))&&(r[1]=e()),r[0]=t,r[1]}(()=>R(r),[r]),i=D();return e("host",{shadowDom:o||"background"==t,intercepted:i,lazy:n||i},n?"video"==t?e(T,{...l,intercepted:i,styleMedia:s}):"background"==t?e(K,{...l}):e(H,{...l,styleMedia:s}):"")}var Z,q;V.observables={type:String,lazy:Boolean,srcset:String,intercepted:Boolean,shadowDom:Boolean,styleMedia:String},Z="ui-lazy-media",q=V,customElements.define(Z,q instanceof z?q:function(e){let t=class extends z{};return t.prototype.render=e,t.observables=e.observables,t.styles=e.styles,t}(q));
//# sourceMappingURL=index.js.map
